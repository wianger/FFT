# 中国人民大学 信息学院

并行与分布式计算 2025 年秋季学期  
实验 4: 傅里叶空间图像相似度计算  

截止日期: 2025 年 12 月 22 日  

---

## 一、目标

本次课程作业通过编写 OpenMP 和 CUDA 版本的傅里叶空间图像相似度计算来熟悉多核 CPU 和众核 GPU 的编程。

## 二、问题描述

在冷冻电镜三维重构程序中，将二维真实图像与空间中的三维结构的投影图像的相似度计算是调用最为频繁的计算，相似度计算的原理是真实图像与投影图像的所有像素在傅里叶空间中的二范数之和，公式如下：

$$
\text{diff} = \sum_{i=1}^N a \times \|\text{image}_i - \text{proj}\|
$$

1. 解压源码包后，根目录下有以下文件：
   - `main.cpp`：计算的主程序。
   - `input.dat`：输入数据文件；
   - `K.dat`：为减小输入文件体积而增加的扰动因子。

2. **不可修改！**
   - `check.dat`：标准结果输出文件，可用于验证程序的计算结果，每个数据的有效数字允许不大于十万分之一的误差。

3. `Makefile`：参赛队员将使用的编译器参数写入 Makefile。

4. 作业考察程序计时部分的运行时间，从数据文件读入结束开始，到结果文件输出结束终止，**时间戳的位置不可修改！**

5. `main.cpp` 中数据文件读取部分不包括在程序计时内。

---

4. `main.cpp` 中的 `m` 和 `K` 值。**不可修改！**

5. `main.cpp` 中函数 `logDataVSPrior` 的最后一行代码 `return result * disturb0;` **不可修改！**

6. 需要手动写出并行 CPU 和 GPU 优化代码。

7. 可以改变数据结构或者数据类型。

8. 如认为有必要，可以将必要的代码修改为其它语言如 CUDA 等。

9. 为控制输入文件的体积，K 次迭代都使用相同的数据文件，并加入一个扰动因子模拟每次迭代处理不同的数据，所以数据计算必须放在 `logDataVSPrior` 函数中，`logDataVSPrior` 函数必须调用 K 次。**利用每次迭代使用同一组数据而减少计算次数的取消成绩！**

## 三、分数

1. **正确性（30%）**  
   请保证程序执行结果是正确的，和串行运行结果一样，允许有误差。

2. **报告书写（30%）**  
   页数限制 2 页（打印出来即一张纸的正反面），在有限的篇幅内说明清楚即可。

3. **实验结果（40%）**  
   给出 CPU 和 GPU 上的加速比并进行合理分析。如果不合理将会查看代码。  
   **要求至少完成 CPU 并行版本。**

## 四、提交

- 在 UniCourse+ 提交实验报告和代码，zip 格式压缩。
- 报告中写明具体位置及如何运行。
- 实验报告最多 2 页。
- 写清楚姓名、学号。
- 需包括以下部分：
  - 问题描述
  - 方法（如何解决问题/算法）
  - 实验（实验环境、结果分析、实验代码如何运行）
  - 结论